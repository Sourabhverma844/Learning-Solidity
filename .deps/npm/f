/**
 * Minified by jsDelivr using Terser v5.19.2.
 * Original file: /npm/f@1.4.0/lib/f.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var http=require("http"),https=require("https"),fs=require("fs"),path=require("path"),parse=require("./parse.js");function f(e,t,r){return e="/"===e[e.length-1]?e:e+"/",t=t||"json",r=r||f.config,function(){var n,o,i,s,a=[].slice.call(arguments),f=function(){},c=!1;if("function"==typeof a[a.length-1]&&(f=a.pop()),"json"===t)i={"Content-Type":"application/json"},n=parse.fromArgList(a),o=new Buffer(JSON.stringify(n));else if("command"===t)i={"Content-Type":"application/json"},n=parse.fromString(a[0]),o=new Buffer(JSON.stringify(n));else{if("file"!==t)return f(new Error("Invalid function mode: "+t));if(!a[0]instanceof Buffer)return f(new Error("Expecting Buffer for function mode: "+t));i={"Content-Type":"application/octet-stream"},n=parse.fromArgList([]),o=a[0]}if("string"==typeof e&&"."===e[0])try{let t=path.join(process.cwd(),"f",e,"index.js"),n=path.join(process.cwd(),"f",e,"function.json");r.local.cache||(delete require.cache[require.resolve(t)],delete require.cache[require.resolve(n)]),(e=require(t)).json=require(n)}catch(t){return f(new Error('Could not find local function "'+e+'"')),!0}return"function"==typeof e?(n.env=process.env.ENV||"dev",n.service=".",n.remoteAddress="::1",n.buffer=o,e(n,((t,r,n)=>{if(t)return f(t);n="object"==typeof(n=n||{})?n:{};let o=e.json&&e.json.http&&e.json.http.headers||{};return o="object"==typeof o?o:{},n=Object.assign(o,n),f(t,r,n)}))):e&&"string"==typeof e?((s=[http,https][443===r.gateway.port|0].request({host:r.gateway.host,method:"POST",headers:i,port:r.gateway.port,path:r.gateway.path+e,agent:!1},(function(e){var t=[];e.on("data",(function(e){t.push(e)})),e.on("end",(function(){var r=Buffer.concat(t),n=e.headers["content-type"]||"";if("application/json"===n){r=r.toString();try{r=JSON.parse(r)}catch(e){r=null}}else n.match(/^text\/.*$/i)&&(r=r.toString());return c=!0,2!=(e.statusCode/100|0)?f(new Error(r)):f(null,r,e.headers)}))}))).on("error",(function(e){c||f(e)})),s.write(o),void s.end()):(f(new Error("Invalid function name")),!0)}}f.config={gateway:{host:"f.stdlib.com",port:443,path:"/"},local:{cache:!0}},module.exports=f;
//# sourceMappingURL=/sm/30bbab0c23aec5691f71057a811c33f2ab63d6258a3ad096a00e713d83636b1e.map